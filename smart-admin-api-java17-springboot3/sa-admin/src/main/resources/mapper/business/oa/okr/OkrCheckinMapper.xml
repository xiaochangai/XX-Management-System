<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lab1024.sa.admin.module.business.oa.okr.dao.OkrCheckinDao">

    <sql id="base_columns">
        t_okr_checkin.checkin_id,
        t_okr_checkin.objective_id,
        t_okr_checkin.key_result_id,
        t_okr_checkin.current_value,
        t_okr_checkin.progress,
        t_okr_checkin.status,
        t_okr_checkin.confidence,
        t_okr_checkin.note,
        t_okr_checkin.create_user_id,
        t_okr_checkin.create_time
    </sql>

    <select id="queryByObjectiveId" resultType="net.lab1024.sa.admin.module.business.oa.okr.domain.vo.OkrCheckinVO">
        select
        <include refid="base_columns"/>,
        t_okr_key_result.title as keyResultTitle,
        t_employee.actual_name as createUserName
        from t_okr_checkin
        left join t_okr_key_result on t_okr_checkin.key_result_id = t_okr_key_result.key_result_id
        left join t_employee on t_okr_checkin.create_user_id = t_employee.employee_id
        where t_okr_checkin.objective_id = #{objectiveId}
        order by t_okr_checkin.checkin_id desc
    </select>

</mapper>
